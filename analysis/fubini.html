<!DOCTYPE html>
<html lang='en'>

<head>
    <base href="..">
    <link rel="stylesheet" type="text/css" media="all" href="assets/main.css"/>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default">
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ TeX: { extensions: ["AMSmath.js"] }});
      </script>
    <title>Fubini's Theorem</title>
</head>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
  * {box-sizing: border-box;}
  
  .header {
    overflow: hidden;
    background-color: #f8f8f885;
    padding: 20px 10px;
  }
  
  .header a {
    float: left;
    color: #050d38;
    text-align: center;
    padding: 12px;
    text-decoration: none;
    font-size: 18px; 
    line-height: 25px;
    border-radius: 4px;
  }
  
  .header a.logo {
    font-size: 25px;
    font-weight: bold;
  }
  
  .header a:hover {
    background-color: #ffffff;
    color: black;
  }
  
  .header a.active {
    background-color: #00baff;
    color: black;
  }
  
  .header-right {
    float: right;
  }
  
  @media screen and (max-width: 500px) {
    .header a {
      float: none;
      display: block;
      text-align: left;
    }
    
    .header-right {
      float: none;
    }
  }

  body{
  background-color: #f8f8f885;
  background-size: cover;
  background-attachment: fixed;
  color: #000000; 
  text-align:left;
  font-family:'Comic Sans MS';
  /*font-family:'Roboto',sans-serif;*/
  font-size:16pt;
  line-height:1.5em;
  margin: 60px auto;
  width: 1000px;
  }
  </style>
  </head>
    <body>
    
    <div class="header">
        <a class="active" href="index.html#notes">Back to Website</a>
    </div>

<body>
  <h4>
    Fubini's Theorem
  </h4>
    <div>
      <ul>
        <li>
            Let \(\mu\) be a measure on \(X\) and \(\nu\) a measure on \(Y\), then \(\mu\times \nu\) (product measure) must 
            be regular on \(X\times Y\), and \(\mu\times \nu(A\times B)=\mu(A)\nu(B)\) whenever \(A,B\) are measurable.
        </li>
        <li>
            For any \(\sigma\)-finite set \(S\subset X\times Y\) the cross sections \(S_y, S_x\) are measurable for almost 
            all \(y, x\) respectively.
        </li>
        <li>
            \(\mu(S_y)\) is \(\nu\)-integrable and \(\nu(S_x)\) is \(\mu\)-integrable. Moreover,
            \[\mu\times \nu(S)=\int_Y \mu(S_y)\mathrm{d}\nu(y)=\int_X \nu(S_x)\mathrm{d}\mu(x)\]
        </li>
        <li>
            For any \(\mu\times\nu\)-integrable function \(f\), \(\sigma\)-finite with respect to \(\mu\times \nu\),
            we have
            \[\int_{X\times Y}f \mathrm{d}\mu\times \nu=\int_Y \left[\int_X f(x,y)\mathrm{d}\mu(x) \right] \mathrm{d} \nu(y)
            =\int_X \left[\int_Y f(x,y)\mathrm{d}\nu(y) \right] \mathrm{d} \mu(x)\]
        </li>
    </ul>
    </div>
    <div>
        <ul style="list-style-type:none;">
          <li>
            <h4>
              Proof.
            </h4>
          </li>
          <li>
            Let \(F\) be the collection of all sets \(S\subset X\times Y\) for which the mapping \(x\mapsto \chi_S(x,y)\)
            is \(\mu\)-integrable for each \(y\in Y\), and the mapping \(y\mapsto \int_X \chi_S(x,y)\mathrm{d}\mu (x)\)
            is \(\nu\)-integrable. \(F\) is closed under countable union.
          </li>
          <li>
            Define
            <ul>
                <li>
                \(S\in F; \rho(S)=\int_Y \left[ \int_X \chi_S(x,y)\mathrm{d} \mu(x)\right]\mathrm{d} \nu(y)\)
                </li>
                <li>
                    \(P_0\) the collection of all \(A\times B\) where \(A\) is a \(\mu\)-measurable set and \(B\) is a \(\nu\)-
                    measurable set.
                </li>
                <li>
                    \(P_1\) generated by \(P_0\) over inifinite union. 
                    Each set in \(P_1\) is a countable disjoint union of sets in \(P_0\).
                </li>
                <li>
                    \(P_2\) generated by \(P_1\) over infinite intersection
                </li>
            </ul>
            Then \(P_0\subset F\) and whenever \(A\times B\in P_0\),
            \[\rho(A\times B)=\int_Y \int_X \chi_{A\times B}(x,y)\mathrm{d}\mu(x)\mathrm{d}\nu(y)=
            \int_Y \mu(A) \chi_B(y)\mathrm{d}\nu(y)=\mu(A)\nu(B).\]
          </li>
          <li>
            Claim 1: For each \(S\in X\times Y\) we have
            \[\mu\times \nu(S)=\inf \{\rho(R)|S\subset R\in P_1\}\]
            Proof of claim: For any \(R=\cup^\infty_{i=1}A_i\times B_i\)
            containing \(S\), we first have
            \[\rho(R)\leq \sum^\infty_{i=1}\rho(A_i\times B_i)=\sum^\infty_{i=1}\mu(A_i)\nu(B_i).\]
            take infimum on both sides, the claim follows.
          </li>
          <li>
            For any \(A\times B\in P_0\), by definition of product measure we have
            \[\mu\times \nu(A\times B)\leq \mu(A)\nu(B).\]
            \(A\times B \in P_0\) gives
            \[\mu(A)\nu(B)=\rho(A\times B)\]
            and claim 1 gives
            \[\rho(A\times B)\geq \mu \times \nu (A\times B)\]
            because LHS is the infimum of RHS.
            Combine all the above, we have
            \[\mu\times \nu(A\times B) = \mu(A)\nu(B).\]
          </li>
          <li>
            Claim 2: \(A\times B\) is \(\mu\times \nu\)-measurable.
          </li>
          <li>
            Proof of claim: Pick any \(T\subset X\times Y\),
            let \(R\in P_1\) containing \(T\). We have
            \[\mu\times\nu (T-(A\times B))+\mu\times \nu(T\cap (A\times B))\leq \rho(R)\]
            LHS is a lower bound of RHS and hence less than the infimum of RHS. By Claim 1 we have
            \[LHS\leq \inf RHS = \mu\times \nu(T)\]
            and therefore \(A\times B\) is \(\mu\times \nu\)-measurable.
          </li>
          <li>
            Claim 3: 
            For each \(S\subset X\times Y\) there is a set \( R \in P_2 \) such that \(S\subset R\) and 
            \[\rho(R)=\mu\times\nu(S).\]
          </li>
          <li>
            Proof of claim: Pick for each natural number \(j\) the following:
            \[\rho(R_j)<\mu\times \nu(S)+\frac{1}{j}\]
            where \(R_j\in P_1\) contains \(S\).
            Define \(R=\cap R_j\in P_2\), then \(R\in F\).
            \[\mu\times \nu(S)\leq \rho(R)\]
            By taking limit on the definition of \(R_j\) we have
            \[\lim_{k\rightarrow \infty} \rho(\cap^k_{j=1}R_j)\leq \mu\times \nu(S).\]
            It remains to show
            \[\rho(R)=\lim_{k\rightarrow \infty} \rho(\cap^k_{j=1}R_j).\]
            By \(\lim \chi_{\cap^k_{j=1} R_j}=\chi_R\) and \(\chi_{\cap^k_{j=1} R_j}\leq \chi_{R_1}\)
            the claim follows from the Dominated Convergence Theorem.
          </li>
          <li>
            Suppose \(S\subset X\times Y\) is \( \mu\times \nu\) -measurable with finite measure. Then there is a \(R\in P_2\)
            such that \(S\subset R\) and 
            \[\mu\times \nu(R-S)=0\]
            hence
            \[\rho(R-S)=0\]
            \[\int_Y\int_X \chi_{R-S}(x,y)\mathrm{d}\mu(x) \mathrm{d}\nu(y)=0\]
            \[\int_Y \mu\{ x:(x,y)\in R-S\} \mathrm{d}\nu(y)=0\]
            so for \(\nu\)-a.e. \(y\in Y\) we have 
            \(\mu(\{x|(x,y)\in S\})=\mu(\{x:(x,y)\in R\}),\)
            and
            \[\mu\times \nu(S)=\rho(R)=\int_Y \mu(\{ x|(x,y)\in S\})\mathrm{d} \nu(y)\]
          </li>
          <li>
            Finally, we can decompose \(f=f^+-f^-\) for general integrable \(f\), and for nonnegative, \(\sigma\)-
            finite function \(f\) we write
            \[f=\sum^\infty_{k=1}\frac{1}{k}\chi_{A_k}.\]
            The remaining proof is all about using the Monotone Convergence Theorem:
            \[
            \begin{align} 
            \int_{X\times Y}f \mathrm{d}\mu\times \nu
            &= \int_{X\times Y}\sum^\infty_{k=1}\chi_{A_k}\mathrm{d} \mu\times \nu\\
            &= \lim_{N\rightarrow \infty}\int_{X\times Y}\sum^N_{k=1}\frac{1}{k} 
            \chi_{A_k} \mathrm{d}\mu\times \nu\\
            &= \lim_{N\rightarrow \infty} \sum^N_{k=1}\frac{1}{k} \int_{X\times Y} 
            \chi_{A_k}\mathrm{d}\mu\times \nu\\
            &= \lim_{N\rightarrow \infty} \sum^N_{k=1}\frac{1}{k}\mu\times \nu(A_k)\\
            &= \lim_{N\rightarrow \infty}\sum^N_{k=1}\frac{1}{k}\ \int_Y \mu(A_k,y)\mathrm{d}\nu(y)\\
            &= \lim_{N\rightarrow \infty}\sum^N_{k=1}\frac{1}{k}\ \int_Y \left[ \int_X \chi_{A_k}\mathrm{d}\mu(x)\right]\mathrm{d}\nu(y)\\
            &= \int_Y \left[ \int_X f(x,y)\mathrm{d}\mu(x)\right] \mathrm{d}\nu(y).
            \end{align}
            \]
          </li>
          </ul>
    </div>
</body>
</body>
</html>